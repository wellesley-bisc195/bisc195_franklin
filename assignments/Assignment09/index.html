<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/stackoverflow-light.css"> <link rel=icon  href="/assets/favicon.png"> <title>Getting set up</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>A theme adapted from <a href="http://lanyon.getpoole.com/" target=_blank >Lanyon</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/syllabus/">Syllabus</a> <a class="sidebar-nav-item " href="/lessons/">Lessons</a> <a class="sidebar-nav-item " href="/lectures-labs/">Lectures & Labs</a> <a class="sidebar-nav-item " href="/assignments/">Assignments</a> </nav> <div class=sidebar-item > <p>&copy; Kevin Bonham, PhD.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >Wellesley College - BISC189</a> <small>Essential Skills for Computational Biology</small> </h3> </div> </div> <div class="container content"> <div class=franklin-content > <h1 id=a_hrefassignmentsassignment09assignment_9_-_getting_set_up ><a href="#a_hrefassignmentsassignment09assignment_9_-_getting_set_up" class=header-anchor ><a href="/assignments/Assignment09">Assignment 9 - Getting set up</a></a></h1> <div class=badges ><a href="https://classroom.github.com/a/"><img src="https://img.shields.io/badge/Github&#37;20-9-darkblue?style&#61;for-the-badge" alt=assignment9link  /></a> <img src="https://img.shields.io/badge/Due-2021--07--09-red?style&#61;for-the-badge" alt=assignment9due  /></div> <p>Let&#39;s continue with our analysis of SARS-CoV2 genomes. But before we do - I want to add one more trick to your workflow. In the following code examples the <strong>package</strong> repo from assignment 8 is called <code>BioinformaticsBISC195.jl</code>, and the <strong>analysis</strong> repo is called <code>CoVAnalsyis</code>.</p> <h2 id=using_revisejl_during_development ><a href="#using_revisejl_during_development" class=header-anchor >Using <code>Revise.jl</code> during development</a></h2> <p>Typically, when you load a package in julia, that package becomes frozen in amber. That is, if you edit the source code after <code>using</code> the package, it is not easy to get these changes to show up in your julia session without restarting julia.</p> <p>For example, start a julia REPL &#40;not in VS Code<sup id="fnref:vscode"><a href="#fndef:vscode" class=fnref >[1]</a></sup>&#41;, change directories to your analysis repo, activate the environment, then load your bioinformatics package.</p> <pre><code class=language-julia >julia&gt; cd&#40;&quot;repos/CoVAnalysis&quot;&#41;

@v1.6&gt; activate .

julia&gt; using BioinformaticsBISC195</code></pre> <p>You should now have access to any functions exported from your package.</p> <pre><code class=language-julia >julia&gt; complement&#40;&#39;A&#39;&#41;
&#39;T&#39;: ASCII/Unicode U&#43;0054 &#40;category Lu: Letter, uppercase&#41;</code></pre> <p><strong>BUT</strong> changing anything in your package repo is now blocked. For example, add and export a new function, or change an existing function to do something different &#40;I changed my <code>complement</code> function to always return <code>42</code>&#41;.</p> <p>Even if you repeat <code>using BioinformaticsBISC195</code>, these changes will not be incorporated into your julia session.</p> <p>Having to restart your julia session each time you change something would make package development a nightmare, but thankfully there&#39;s a better way.</p> <p>The <a href="https://timholy.github.io/Revise.jl/stable/"><code>Revise.jl</code> package</a> comes to the resuce. It&#39;s a bit magical - to be honest, I don&#39;t understand how it works, but if you load it &#40;<code>using Revise</code>&#41; <em>before</em> loading your package, then new changes you enter will be incorporated into your running julia session. This package is so widely used that the julia VS code extension loads it by default &#40;which is why I said not to open a REPL in VS Code&#41;.</p> <p>Try it out - restart julia, then repeat the above process, but do <code>using Revise</code> right before <code>using BioinformaticsBISC195</code>.</p> <p>Note: don&#39;t forget to revert the changes you made to your package code.</p> <p>With this in mind, you&#39;re ready to continue working on coronavirus analysis. As you go forward, put reusable code &#40;eg new functions and types&#41; into your package repository, while analysis-specific code &#40;eg loading files, calculating stats, plots&#41; should go into your analysis repo.</p> <p>Don&#39;t forget to describe the analyses you&#39;re performing in your markdown notebooks.</p> <h2 id=continuing_cov_analysis ><a href="#continuing_cov_analysis" class=header-anchor >Continuing CoV analysis</a></h2> <p>In the previous lesson, we calculated the mean and standard deviation of sequence lengths. But mean and standard deviation are really only descriptive if the lengths of the sequences follow a <a href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>.</p> <p>The <code>minimum&#40;&#41;</code> and <code>maximum&#40;&#41;</code> functions take vectors as arguments, and return the smallest and largest values respectively.</p> <p>For all of the following task, record the results in your analysis notebook repository. Be sure to describe the steps you&#39;re taking, and explain why.</p> <div class=colbox-purple ><div class=title >To Do</div> <p>Use the <code>minimum&#40;&#41;</code> and <code>maximum&#40;&#41;</code> functions to find the length of the shortest and longest coronavirus genome in your dataset. Do the values make sense, given the mean length?</p></div> <h3 id=identifying_outliers ><a href="#identifying_outliers" class=header-anchor >Identifying outliers</a></h3> <p>In the dataset I downloaded, there are several genomes that are very small - less than 1000 bases when the mean length is closer to 30k bases.</p> <p>How did I figure this out? I promise I didn&#39;t look at the genome file by hand&#33;</p> <p>One of the easiest ways to get an overview of a dataset is to make some exploratory plots. For this, we can use the <a href="http://docs.juliaplots.org/latest/"><code>Plots.jl</code></a> package, which makes it very easy to make plots with your data in julia.</p> <pre><code class=language-julia ># having previously created a vector with the lengths of my sequences...
using Plots

histogram&#40;seq_lengths&#41;</code></pre> <p><img src="/assets/img/coronavirus_lengths.png" alt="coronavirus genome lengths" /></p> <div class=colbox-blue ><div class=title >Note</div> <p>When I first wrote this assignment, There were a bunch of very short sequences. This may no longer be correct - if your sequences don&#39;t contain outliers, your results may differ.</p></div> <div class=colbox-purple ><div class=title >To Do</div> <ol> <li><p>Use the <code>Plots</code> package to create a histogram of your coronavirus genome lengths.</p> <li><p>Look at the documentation for the <code>Plots.jl</code> package and see if you can figure out how to remove the legend and add more descriptive axis labels to this plot</p> </ol></div> <p>I&#39;d expect most coronaviruses to have similar length genomes, so anything less than 25k bases is probably a mistake. Take note&#33; Datasets like this are never perfect - it&#39;s always worth your time to make sure there aren&#39;t errors.</p> <div class=colbox-purple ><div class=title >To Do</div> <p>Filter your sequences to remove any that have a length of less than 25k bases<sup id="fnref:filtering"><a href="#fndef:filtering" class=fnref >[2]</a></sup>. There are a couple of different ways to do this - but keep in mind that, if the headers and sequences from your fasta file are separate, you need to make sure that you remove the headers that correspond to short sequences as well.</p> <p>Some possibilities:</p> <ol> <li><p>Add a filter to your <code>parse_fasta&#40;&#41;</code> function. This is not ideal, since it makes the function less generalizable to other problems.</p> <li><p>Find the index of all the sequences that are less than 25K bases long, then remove the items at those indices from the sequence vector and the headers vector. Take a look at the <code>findall&#40;&#41;</code> function if you plan to take this path. Warning: if you remove things one by one, you may change the indices of other things in the vector.</p> <li><p>Loop through the sequences, and, if they are long enough, push them into a new vector. Again - be sure to take care of the headers as well.</p> <li><p>Find the index of all of the sequences that are <em>longer</em> than 25k bases, and then take a slice of the original vector. Again, <code>findall&#40;&#41;</code> may be useful here.</p> </ol> <p>Whatever you do, you should ensure that:</p> <ol> <li><p>The <code>minimum&#40;&#41;</code> of the sequence length is actually &gt; 25k bases.</p> <li><p>If your sequence and header vectors are separate, they should have the same length.</p> </ol></div> <div class=colbox-green ><div class=title >Tip</div> <p>You can use <code>@assert</code> to make sure that your code did what you expect. <code>@assert</code> followed by a boolean expression will throw an error if the expression is <code>false</code>.</p> <pre><code class=language-julia >julia&gt; @assert 1 &#61;&#61; 1

julia&gt; @assert 1 &#61;&#61; 2
ERROR: AssertionError: 1 &#61;&#61; 2
Stacktrace:
&#91;1&#93; top-level scope at REPL&#91;13&#93;:1</code></pre> <p>So you might do <code>@assert length&#40;header_vector&#41; &#61;&#61; length&#40;sequence_vector&#41;</code> for example.</p></div> <table class=fndef  id="fndef:filtering"> <tr> <td class=fndef-backref ><a href="#fnref:filtering">[2]</a> <td class=fndef-content >if all of your sequences are &gt;25k bases, instead select a length that removes at least 5&#37; of sequences, just to practice. Use the histogram to pick the cutoff. Be sure to describe your process in your notebook. </table> <h3 id=plot_the_result ><a href="#plot_the_result" class=header-anchor >Plot the result</a></h3> <div class=colbox-purple ><div class=title >To Do</div> <p>Create a new histogram that shows the distribution of filtered sequences. It should look something like this:</p> <p><img src="/assets/img/filtered_coronavirus_lengths.png" alt="filtered histogram" /></p></div> <h2 id=kmer_analysis_of_coronavirus_genomes ><a href="#kmer_analysis_of_coronavirus_genomes" class=header-anchor >Kmer analysis of coronavirus genomes</a></h2> <p>The best way to reason about how closely related two sequences are is to use some &quot;<a href="https://en.wikipedia.org/wiki/Metric_&#40;mathematics&#41;">distance metric</a>&quot;. Sequences that are closer together are inferred to share a common ancestor more recently than sequences that are further apart.</p> <p>The most widely-used distance metrics typically come from <a href="https://en.wikipedia.org/wiki/Sequence_alignment#Multiple_sequence_alignment">doing an alignment</a>.</p> <p>Instead, we can do a quick-and-dirty analysis by comparing the unique kmers in a sequence. Look back to <a href="/assignments/Assignment04">Assignment04</a>, where you created a function to count the kmers in a sequence.</p> <h2 id=unique_kmers ><a href="#unique_kmers" class=header-anchor >Unique kmers</a></h2> <p>Here, we don&#39;t need to count the kmers, we just want to know which kmers of a given length are present. You might find it useful to use the <code>Set</code> type, which is an unordered collection of unique elements:</p> <pre><code class=language-julia >julia&gt; my_set &#61; Set&#40;&#91;1,1,1,1,1,1,2,2,2,2,2&#93;&#41;
Set&#123;Int64&#125; with 2 elements:
  2
  1

julia&gt; push&#33;&#40;my_set, 3&#41;
Set&#123;Int64&#125; with 3 elements:
  2
  3
  1

julia&gt; push&#33;&#40;my_set, 3&#41; # since 3 is already in it, nothing changes
Set&#123;Int64&#125; with 3 elements:
  2
  3
  1

julia&gt; union&#33;&#40;my_set, &#91;3,3,3,3,3,4,4,4,4,4,4&#93;&#41;
Set&#123;Int64&#125; with 4 elements:
  4
  2
  3
  1</code></pre> <div class=colbox-purple ><div class=title >To Do</div> <p>Add a function to your bioinformatics package that takes 2 arguments - a sequence and an integer &#40;<code>k</code>&#41;, and returns all of the unique kmers of length <code>k</code></p> <p>Do not keep kmers with ambiguous bases &#40;anything other than <code>A</code>, <code>T</code>, <code>G</code>, or <code>C</code>&#41;.</p></div> <div class=colbox-green ><div class=title >Tip</div> <p>This function may take a long time to run on all of your genomes. Use a small subset of genomes and/or the <code>ex1.fasta</code> file while you&#39;re working on it to make sure it works before trying to run it with all of your genomes.</p></div> <h3 id=comparing_unique_kmers ><a href="#comparing_unique_kmers" class=header-anchor >Comparing unique kmers</a></h3> <p>We can now use set theory to compare genomes to one another.</p> <p>The &quot;union&quot; of two or more sets is the set containing all of the elements found in any set.</p> <pre><code class=language-julia >julia&gt; s1 &#61; Set&#40;&#91;1,2,3&#93;&#41;; s2 &#61; Set&#40;&#91;2,3,4&#93;&#41;;

julia&gt; union&#40;s1, s2&#41;
Set&#123;Int64&#125; with 4 elements:
  4
  2
  3
  1</code></pre> <p>The &quot;intersection&quot; of two or more sets is the set of elements that occur in all of the sets.</p> <pre><code class=language-julia >julia&gt; intersect&#40;s1, s2&#41;
Set&#123;Int64&#125; with 2 elements:
  2
  3</code></pre> <p>While the &quot;difference&quot; refers the the elements of the first set but not in any of the other sets.</p> <pre><code class=language-julia >julia&gt; setdiff&#40;s1, s2&#41;
Set&#123;Int64&#125; with 1 element:
  1

julia&gt; setdiff&#40;s2, s1&#41;
Set&#123;Int64&#125; with 1 element:
  4</code></pre> <p>A distance metric should have the following features:</p> <ul> <li><p>Should be a positive number between 0 and 1</p> <li><p>Identical things should have a distance of 0</p> <li><p>Things with absolutely no similarity should have a distance of 1</p> </ul> <p>To do this with our kmer sets, we can define a distance metric that is <code>1 - &#40;length of intersection / length of union&#41;</code>.</p> <p>Or alternatively, <code>&#40;&#40;length of set1 - set2&#41; &#43; &#40;length of set2 - set1&#41;&#41; / length of union</code>.</p> <div class=colbox-purple ><div class=title >To Do</div> <p>Add a function to your bioinformatics package that takes two kmer sets and calculates the distance between them.</p> <p>In the next lesson, we&#39;ll use the distances between sequences to learn something about the evolution of SARS-related coronaviruses.</p></div> <h2 id=completion_checklist ><a href="#completion_checklist" class=header-anchor >Completion Checklist</a></h2> <ul> <li><p>&#91; &#93; Further description of sequence lengths</p> <ul> <li><p>&#91; &#93; get the smallest and largest sequence length</p> <li><p>&#91; &#93; use <code>histogram&#40;&#41;</code> from <code>Plots</code> on sequence lengths</p> </ul> <li><p>&#91; &#93; Filter sequences to remove anything &lt; 25k basepairs long</p> <ul> <li><p>&#91; &#93; Create histogram of filtered sequence lengths</p> </ul> <li><p>&#91; &#93; Unique kmer function that discards kmers with ambiguous bases</p> <li><p>&#91; &#93; Kmer set distance function that returns a distance metric</p> </ul> <table class=fndef  id="fndef:vscode"> <tr> <td class=fndef-backref ><a href="#fnref:vscode">[1]</a> <td class=fndef-content >The Julia language extension of VS Code loads <code>Revise.jl</code> automatically if you have it installed. </table> <div class=page-foot > <div class=copyright > &copy; Kevin Bonham, PhD. Last modified: August 18, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <script src="/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <label for=sidebar-checkbox  class=sidebar-toggle ></label>