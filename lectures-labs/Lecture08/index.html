<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/katex/katex.min.css"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/stackoverflow-light.css"> <link rel=icon  href="/assets/favicon.png"> <title>Finishing alignments</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>A theme adapted from <a href="http://lanyon.getpoole.com/" target=_blank >Lanyon</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/syllabus/">Syllabus</a> <a class="sidebar-nav-item " href="/lessons/">Lessons</a> <a class="sidebar-nav-item " href="/lectures-labs/">Lectures & Labs</a> <a class="sidebar-nav-item " href="/assignments/">Assignments</a> </nav> <div class=sidebar-item > <p>&copy; Kevin Bonham, PhD.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >Wellesley College - BISC189</a> <small>Essential Skills for Computational Biology</small> </h3> </div> </div> <div class="container content"> <div class=franklin-content > <h1 id=a_hreflectures-labslecture08lecture_8_-_finishing_alignments ><a href="#a_hreflectures-labslecture08lecture_8_-_finishing_alignments" class=header-anchor ><a href="/lectures-labs/Lecture08">Lecture 8 - Finishing alignments</a></a></h1> <div class=badges ><img src="https://img.shields.io/badge/Date-2021--07--02-orange?style&#61;for-the-badge" alt=lesson8date  /> <a href="/lectures-labs/slides/lecture08_slides.pdf"><img src="https://img.shields.io/badge/Slides-8-blue?style&#61;for-the-badge" alt="Lecture8 slides" /></a></div> <h2 id=continuing_from_lab07 ><a href="#continuing_from_lab07" class=header-anchor >Continuing from Lab07</a></h2> <h3 id=alignment_tracing_for_nw_and_sw ><a href="#alignment_tracing_for_nw_and_sw" class=header-anchor >Alignment tracing for NW and SW</a></h3> <ul> <li><p>start from <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(i,j)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> where <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> and <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> are</p> <ul> <li><p>the last indices in 1st and 2nd dimension for NW</p> <li><p>the indices for the matrix with the maximum score in SW</p> </ul> <li><p>Check the score from </p> <ol> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mi>i</mi><mo separator=true >,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(i,j-1)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> &#40;cell to the left&#41;, a gap score</p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>j</mi><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(i-1,j)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> &#40;cell above&#41;, a gap score</p> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>M</mi><mrow><mo stretchy=false >(</mo><mi>i</mi><mo>−</mo><mn>1</mn><mo separator=true >,</mo><mi>j</mi><mo>−</mo><mn>1</mn><mo stretchy=false >)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">M_{(i-1,j-1)}</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class=mord ><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class=msupsub ><span class="vlist-t vlist-t2"><span class=vlist-r ><span class=vlist  style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.10903em;margin-right:0.05em;"><span class=pstrut  style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mbin mtight">−</span><span class="mord mtight">1</span><span class="mclose mtight">)</span></span></span></span></span><span class=vlist-s >​</span></span><span class=vlist-r ><span class=vlist  style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span> &#40;cell from diagonal&#41;, a match or mismatch </p> </ol> <li><p>If any match your current cell, push correct characters to alignments</p> <ol> <li><p>push gap to <code>seq1</code>, character at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> to <code>seq2</code></p> <li><p>push character at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> to <code>seq1</code>, gap to <code>seq2</code></p> <li><p>push character at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathnormal">i</span></span></span></span> to <code>seq1</code>, character at <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> to &#61;seq2&#61;</p> </ol> <li><p>update indices</p> </ul> <h3 id=special_considerations ><a href="#special_considerations" class=header-anchor >Special considerations</a></h3> <ul> <li><p>Be mindful of what happens when you hit the first row or first column</p> <ul> <li><p><span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.74285em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">i</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> or <span class=katex ><span class=katex-mathml ><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j-1</annotation></semantics></math></span><span class=katex-html  aria-hidden=true ><span class=base ><span class=strut  style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span><span class=mbin >−</span><span class=mspace  style="margin-right:0.2222222222222222em;"></span></span><span class=base ><span class=strut  style="height:0.64444em;vertical-align:0em;"></span><span class=mord >1</span></span></span></span> may throw bounds error</p> </ul> <li><p>When should your loop stop?</p> <ul> <li><p>It will be different for Needleman-Wunsch than for Smith-Waterman</p> </ul> </ul> <h3 id=a_test_suite ><a href="#a_test_suite" class=header-anchor >A test suite:</a></h3> <pre><code class=language-julia >@testset &quot;Lab07&quot; begin
    @test nwalign&#40;&quot;AATTGGCC&quot;, &quot;AATTTGCC&quot;&#41; &#61;&#61; &#40;&quot;AATTGGCC&quot;, &quot;AATTTGCC&quot;&#41;
    @test any&#40;aln -&gt; aln &#61;&#61; nwalign&#40;&quot;AATTGGCC&quot;, &quot;AAGGTTCC&quot;&#41;, &#91;
            &#40;&quot;AA--TTGGCC&quot;, &quot;AAGGTT--CC&quot;&#41;,
            &#40;&quot;AATTGGCC&quot;, &quot;AAGGTTCC&quot;&#41;&#93;&#41;
    @test nwalign&#40;&quot;AATTGGCC&quot;, &quot;AAGGTTCC&quot;, gap&#61;-2&#41; &#61;&#61; &#40;&quot;AATTGGCC&quot;, &quot;AAGGTTCC&quot;&#41;
    @test nwalign&#40;&quot;AATTGGCC&quot;, &quot;AAGGTTCC&quot;, mismatch&#61;-2&#41; &#61;&#61; &#40;&quot;AA--TTGGCC&quot;, &quot;AAGGTT--CC&quot;&#41;

    @test swalign&#40;&quot;AAT&quot;, &quot;AA&quot;&#41; &#61;&#61; &#40;&quot;AA&quot;, &quot;AA&quot;&#41;
    @test swalign&#40;&quot;AAAAATTGGCCAAAAA&quot;, &quot;ATTGGCCA&quot;&#41; &#61;&#61; &#40;&quot;ATTGGCCA&quot;, &quot;ATTGGCCA&quot;&#41;
    @test swalign&#40;&quot;AAAAATTGGCCAAAAA&quot;, &quot;ATTGGCAAA&quot;&#41; &#61;&#61; &#40;&quot;ATTGGCCAAA&quot;, &quot;ATTGGC-AAA&quot;&#41;
end</code></pre> <div class=page-foot > <div class=copyright > &copy; Kevin Bonham, PhD. Last modified: August 18, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <script src="/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <label for=sidebar-checkbox  class=sidebar-toggle ></label>