<!doctype html> <html lang=en > <meta charset=UTF-8 > <meta name=viewport  content="width=device-width, initial-scale=1"> <link rel=stylesheet  href="/libs/highlight/github.min.css"> <link rel=stylesheet  href="/css/franklin.css"> <link rel=stylesheet  href="/css/poole_lanyon.css"> <link rel=stylesheet  href="/css/adjust.css"> <link rel=stylesheet  href="/css/stackoverflow-light.css"> <link rel=icon  href="/assets/favicon.png"> <title>Smith-Waterman</title> <input type=checkbox  class=sidebar-checkbox  id=sidebar-checkbox > <div class=sidebar  id=sidebar > <div class=sidebar-item > <p>A theme adapted from <a href="http://lanyon.getpoole.com/" target=_blank >Lanyon</a>.</p> </div> <nav class=sidebar-nav > <a class="sidebar-nav-item " href="/">Home</a> <a class="sidebar-nav-item " href="/syllabus/">Syllabus</a> <a class="sidebar-nav-item " href="/lessons/">Lessons</a> <a class="sidebar-nav-item " href="/lectures-labs/">Lectures & Labs</a> <a class="sidebar-nav-item " href="/assignments/">Assignments</a> </nav> <div class=sidebar-item > <p>&copy; Kevin Bonham, PhD.</p> </div> </div> <!-- Wrap is the content to shift when toggling the sidebar. We wrap the content to avoid any CSS collisions with our real content. --> <div class=wrap > <div class=masthead > <div class=container > <h3 class=masthead-title > <a href="/" title=Home >Wellesley College - BISC189</a> <small>Essential Skills for Computational Biology</small> </h3> </div> </div> <div class="container content"> <div class=franklin-content > <h1 id=a_hreflectures-labslecture06lecture_6_-_smith-waterman ><a href="#a_hreflectures-labslecture06lecture_6_-_smith-waterman" class=header-anchor ><a href="/lectures-labs/Lecture06">Lecture 6 - Smith-Waterman</a></a></h1> <div class=badges ><img src="https://img.shields.io/badge/Date-2021--06--24-orange?style&#61;for-the-badge" alt=lesson6date  /> <a href="#"><img src="https://img.shields.io/badge/Slides-NA-blue?style&#61;for-the-badge" alt="Lecture6 slides" /></a></div> <h2 id=smith-waterman_alignment ><a href="#smith-waterman_alignment" class=header-anchor >Smith-Waterman alignment</a></h2> <div class=colbox-blue ><div class=title >Note</div> <p>I changed the name of the repository and the module from <code>BISC195Labs</code> to <code>AlignmentAlgorithms</code>. Sorry for any confusion this causes.</p></div> <p>After completing labs 3-5, you should now have the functionality to take 2 biological sequences, construct an appropriate scoring matrix, and score it.</p> <pre><code class=language-julia-repl >julia&gt; using AlignmentAlgorithms

julia&gt; nwscorematrix&#40;&quot;AAATG&quot;, &quot;AATG&quot;&#41;
6×5 Matrix&#123;Int64&#125;:
  0  -1  -2  -3  -4
 -1   1   0  -1  -2
 -2   0   2   1   0
 -3  -1   1   1   0
 -4  -2   0   2   1
 -5  -3  -1   1   3

 julia&gt; nwscorematrix&#40;&quot;AAATG&quot;, &quot;AATG&quot;; gap&#61;-2, match&#61;2&#41;
6×5 Matrix&#123;Int64&#125;:
   0  -2  -4  -6  -8
  -2   2   0  -2  -4
  -4   0   4   2   0
  -6  -2   2   3   1
  -8  -4   0   4   2
 -10  -6  -2   2   6</code></pre> <p>Before we get to the task of actually constructing our alignments, let&#39;s take a look at another alignment - <a href="https://en.wikipedia.org/wiki/Smith&#37;E2&#37;80&#37;93Waterman_algorithm#Example">Smith-Waterman</a>.</p> <h2 id=smith_waterman_for_local_alignment ><a href="#smith_waterman_for_local_alignment" class=header-anchor >Smith Waterman for local alignment</a></h2> <p>Whereas Needleman-Wunsch is a &quot;global&quot; alignment algorithm, that attempts to align the entire length of two sequences, Smith-Waterman is a &quot;local&quot; alignment algorithm, which can find regions of similarity nested within sequences that are quite dissimilar overall.</p> <p>SW takes a similar approach to NW, in that a scoring matrix is used to follow matches, mismatches, and gaps, with options for different scoring systems. The primary difference is that in SW, there are no negative scores allowed in any cell of the matrix. If a cell&#39;s best score would be negative, a zero is added instead.</p> <p>To find the best local alignment, the highest score in the matrix is found, and then followed backward along its scoring path until a 0 is reached. Check out this animation from wikipedia:</p> <p><img src="https://upload.wikimedia.org/wikipedia/commons/9/92/Smith-Waterman-Algorithm-Example-En.gif" alt="sw gif" /></p> <h2 id=your_task ><a href="#your_task" class=header-anchor >Your task</a></h2> <p>Add new functions to your lab repository to build a Smith-Waterman scoring matrix.</p> <p>If you add the following test set to your <code>test/runtests.jl</code>, they should pass:</p> <pre><code class=language-julia >@testset &quot;Lab06&quot; begin
    scoremat &#61; swscorematrix&#40;&quot;AAACCCGGG&quot;,&quot;TTTCCCAAA&quot;&#41;
    @test maximum&#40;swscorematrix&#40;&quot;AAACCCGGG&quot;,&quot;TTTCCCAAA&quot;&#41;&#41; &#61;&#61; 3
    @test maximum&#40;swscorematrix&#40;&quot;AAACCCGGG&quot;,&quot;TTTCCCAAA&quot;; match&#61;2&#41;&#41; &#61;&#61; 6
    @test maximum&#40;swscorematrix&#40;&quot;AAACCCGGG&quot;,&quot;TTTCCCAAA&quot;; gap&#61;-2&#41;&#41; &#61;&#61; 3
    @test maximum&#40;swscorematrix&#40;&quot;AAACCCGGG&quot;,&quot;TTTCCCAAA&quot;; mismatch&#61;-2&#41;&#41; &#61;&#61; 3

    @test swscorematrix&#40;&quot;GGTTGACTA&quot;, &quot;TGTTACGG&quot;; match&#61;3, mismatch&#61;-3, gap&#61;-2&#41; &#61;&#61;
        &#91;0  0  0  0  0   0   0   0  0
         0  0  3  1  0   0   0   3  3
         0  0  3  1  0   0   0   3  6
         0  3  1  6  4   2   0   1  4
         0  3  1  4  9   7   5   3  2
         0  1  6  4  7   6   4   8  6
         0  0  4  3  5  10   8   6  5
         0  0  2  1  3   8  13  11  9
         0  3  1  5  4   6  11  10  8
         0  1  0  3  2   7   9   8  7&#93;
end</code></pre> <div class=page-foot > <div class=copyright > &copy; Kevin Bonham, PhD. Last modified: August 18, 2021. Website built with <a href="https://github.com/tlienart/Franklin.jl">Franklin.jl</a> and the <a href="https://julialang.org">Julia programming language</a>. </div> </div> </div> </div> </div> <script src="/libs/highlight/highlight.pack.js"></script> <script>hljs.initHighlightingOnLoad();hljs.configure({tabReplace: ' '});</script> <label for=sidebar-checkbox  class=sidebar-toggle ></label>